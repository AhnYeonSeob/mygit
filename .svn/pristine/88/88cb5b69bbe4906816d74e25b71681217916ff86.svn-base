<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
    
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@taglib uri="http://www.springframework.org/tags/form" prefix="form"%>
<%@taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn" %>
<%@ taglib uri="http://www.springframework.org/security/tags" prefix="security"%>  
    
<h4>학생증 카드 신청 목록 조회 </h4>

<script>
    const contextPath = "${pageContext.request.contextPath}/";
</script>


<style>


.custom-btn {
    background: none; /* 배경 제거 */
    border: none; /* 버튼 테두리 제거 */
    padding: 5px; /* 버튼 내부 여백 */
    display: flex;
    align-items: center; /* 버튼 안의 요소 정렬 */
    justify-content: center;
    cursor: pointer;
}

.custom-img {
    width: 30px; /* 이미지 너비 */
    height: 30px; /* 이미지 높이 */
    margin-right: 5px; /* 이미지와 텍스트 간격 */
}

</style>
<table class="table table-bordered">
    <tr>

		<div class="search-area" data-pg-target="#searchForm" 
		data-pg-fn-name="fnPaging" style="text-align: right">
					<form:select path="condition.searchType">
						<form:option value="" label="전체" />
						<form:option value="title" label="처리상태" />
						<form:option value="writer" label="작성자" />
					</form:select>
					<form:input path="condition.searchWord"/>
					<button id="search-btn" class="btn btn-primary">검색</button>
				</div>


	</tr>

	<thead>
	<tr>                        
		<th style="width:50px; height: 50px;">순번</th>
		<th style="width:150px">학번</th>
		<th style="width:150px">학과</th>
		<th style="width:200px">이름</th>
		<th style="width:300px">요청일시</th>
		<th style="width:80px">상태</th>
		<tr>
	
	
	</thead>
	<tbody align="center">
		<c:if test="${not empty card}">

			<c:forEach items="${card}" var="card">


				<tr data-stu-id ="${card.stuId }">

					<td>${card.rnum}</td>
					<td>${card.stuId}</td>
					<td>컴퓨터 공학과</td>
					<td>${card.studentVO.nm}</td>
					<td>${fn:split(card.stuCardDate, 'T')[0]} ${fn:split(card.stuCardDate, 'T')[1]}</td>
					<td>
				        <button class="btn ${card.commonCodeVO.cocoStts == '요청' ? 'btn-success' : 
				                            (card.commonCodeVO.cocoStts == '발급' ? 'btn-danger' : 'btn-secondary')} statusBtn">
				            				${card.commonCodeVO.cocoStts}
				        </button>
				    </td>
				</tr>
			</c:forEach>
		</c:if>
		<c:if test="${empty card}">
			<tr>
				<td colspan="4">글 없음.</td>
			</tr>
		</c:if>
	</tbody>
	<tfoot>

<tr style="text-align: center;">
			<td colspan="9">
				<div class="paging-area">${pagingHTML }</div>

			</td>

		</tr>
		
</tfoot>

</table>

<form:form id="searchForm" method="get" modelAttribute="condition">
    <form:input path="searchType" style="display: none;" />
    <form:input path="searchWord" style="display: none;" />
    <input type="hidden" name="page" />
</form:form>

<script src="${pageContext.request.contextPath }/resources/js/utils/paging.js"></script>
<script src="${pageContext.request.contextPath }/resources/js/studentCard/studentCardStatus.js"></script>
          