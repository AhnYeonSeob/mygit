/**
 * 
 */
document.addEventListener("DOMContentLoaded", () => {

	const delBtn = document.querySelector("#deleteBtn");
	const applyBtn = document.querySelector("#applyBtn");


	delBtn.addEventListener("click", (e) => {
		e.preventDefault();
		console.log("삭제버튼");

		const updateData = {
			jobNo: document.getElementById("detail-id").textContent
		};
		console.log("삭제할 게시글", updateData);
		swal({
			title: "정말로 삭제하시겠습니까?",
			//text: ,
			icon: "warning",
			buttons: ["취소", "삭제"],
			dangerMode: true,
		}).then(btnVal => {
			if (btnVal) {
				axios.put(`/yguniv/jobboard/${updateData.jobNo}/delete`, updateData)
					.then(resp => {
						swal({
							title: "삭제완료",
							text: "게시글이 성공적으로 삭제되었습니다",
							icon: "success",
							button: "확인"
						}).then(() => {
							location.href = '/yguniv/jobboard';
						});
					}).catch(err => {
						swal({
							title: "삭제실패",
							text: err.response.data.message,
							icon: "error",
							button: "확인"
						});
					})
			}
		});
	})

	applyBtn.addEventListener("click", () => {
		const updateData = {
			jobNo: document.getElementById("apply-jobno").textContent,
			stuId: document.getElementById("apply-id").textContent
		};

		axios.post(`/yguniv/eventregistrant`, updateData)
			.then(resp => {
				swal({
					title: "신청 완료",
					text: "채용설명회가 성공적으로 신청되었습니다.",
					icon: "success",
					button: "확인"
				}).then(() => {
					location.href = `/yguniv/jobboard/${updateData.jobNo}`;
				});
			})
			.catch(err => {
				if (err.response && err.response.status === 409) {
					// 중복된 신청 알림
					swal({
						title: "신청 실패",
						text: "이미 신청된 데이터입니다.",
						icon: "warning",
						button: "확인"
					});
				} else {
					// 기타 오류
					swal({
						title: "신청 실패",
						text: "오류가 발생했습니다. 다시 시도해주세요.",
						icon: "error",
						button: "확인"
					});
				}
			});
	});

});





