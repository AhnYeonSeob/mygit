<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib uri="http://www.springframework.org/tags/form" prefix="form"%>
<%@ taglib uri="http://www.springframework.org/tags" prefix="spring"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn"%>
<%@ taglib uri="http://www.springframework.org/security/tags" prefix="security"%>

<nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item">장학금 신청 내역</li>
    <li class="breadcrumb-item active" aria-current="page">장학금 신청 내역 조회</li>
  </ol>
</nav>
<input type="hidden" value="${ask.shapDocNo }" id="shapDocNo" />
<input type="hidden" value="${ask.stuId }" id="stuId" />
<script>
    const contextPath = "${pageContext.request.contextPath}/";
</script>

<style>


.table {
    width: 70%;
    margin: 0 auto;
    border-collapse: collapse;
}
</style>
<table class="table table-primary">

				<tr>
				   <th style="text-align: center; height: 50px;">상태</th>

				    	<td class="bg-light">${ask.commonCodeVO.cocoStts}</td>
				    <th style="text-align: center; height: 50px;" >반려사유</th>
					    <td class="bg-light">
					        <c:if test="${empty ask.shapNoReason}">
					            - <!-- 반려사유가 없을 때 -->
					        </c:if>
					        <c:if test="${not empty ask.shapNoReason}">
					            <span style="color: red;">${ask.shapNoReason}</span> <!-- 반려사유가 있을 때 -->
					        </c:if>
					    </td>
				</tr>
                <tr>
                <th style="text-align: center; height: 50px;">접수일자</th>
                	<td class="bg-light">${fn:split(ask.shapRcptDate, 'T')[0] } ${fn:split(ask.shapRcptDate, 'T')[1] }</td>
                <th style="text-align: center; height: 50px;">승인일자</th>
		            <td id="approvalDate" class="bg-light">
					    ${fn:split(ask.shapChcDate, 'T')[0]} ${fn:split(ask.shapChcDate, 'T')[1]}
					</td>
           </tr>
            <tr>
                <th style="text-align: center; height: 50px;">학기번호</th>
                <td class="bg-light"> ${fn:substring(ask.semstrNo, 0, 4)}-${fn:substring(ask.semstrNo, 4, 6)} </td>
                <th style="text-align: center; height: 50px;">장학금이름</th>
                <td class="bg-light">${ask.awardVO.awardNm}</td>
            </tr>
            
           
            
           
            <tr>
                <th style="text-align: center; height: 50px;">학번</th>
                <td class="bg-light">${ask.stuId}</td>
                <th style="text-align: center; height: 50px;">이름</th>
                <td class="bg-light">${ask.studentVO.nm}</td>
            </tr>
           
     
        
            <tr>
                <th style="text-align: center; height: 50px;">생년월일</th>
            
               <td colspan="3" class="bg-light"> 
				    ${fn:substring(fn:replace(ask.studentVO.brdt, '-', ''), 0, 4)}년&nbsp;
				    ${fn:substring(fn:replace(ask.studentVO.brdt, '-', ''), 4, 6)}월&nbsp;
				    ${fn:substring(fn:replace(ask.studentVO.brdt, '-', ''), 6, 8)}일
				</td>

                
                  
            </tr>
            <tr>
                <th style="text-align: center; height: 50px;">집주소</th>
            <td colspan="4" class="bg-light">(${ask.studentVO.zip}) &nbsp;  ${ask.studentVO.rdnmadr} &nbsp;  ${ask.studentVO.daddr}</td>
                 
            </tr>
            <tr>
                <th style="text-align: center; height: 50px;">전화번호</th>
            <td colspan="4" class="bg-light">
            ${ask.studentVO.mbtlnum}
            </td>
                 
            </tr>
           
            <tr>
                <th style="text-align: center; height: 50px;">이메일</th>
            <td colspan="4" class="bg-light">${ask.studentVO.eml}</td>
                 
            </tr>
           
           
            <tr>
                <th style="text-align: center; height: 50px;">첨부파일</th>
	                <td colspan="3" class="bg-light">
		              <c:forEach items="${ask.atchFile.fileDetails }" var="fd" varStatus="vs">
				
				
				<c:url value='/askAward/${ask.shapDocNo}/atch/${fd.atchFileId}/${fd.fileSn}' var="downUrl"/>
				
				<a href="${downUrl }">${fd.orignlFileNm }(${fd.fileFancysize })</a>
				${not vs.last ? '|' : ''}
			</c:forEach>
			
					<c:if test="${empty ask.atchFile.fileDetails}">
					    첨부파일없음
					</c:if>
					</td>
            </tr>
</table>


			<div align="right">
			    <c:if test="${ask.commonCodeVO.cocoStts != '승인' && ask.commonCodeVO.cocoStts != '반려'}">
			        <form action="<c:url value='/askAward/delete/${ask.shapDocNo}' />" method="post" style="display:inline;">
			            <button type="submit" class="btn btn-danger">삭제</button>
			        </form>
			    </c:if>
			    <a href="<c:url value='/askAward/selectStudent/${ask.stuId}' />" class="btn btn-primary">목록</a>
			</div>


<!-- 이거는 게시물 삭제  -->
<script src="${pageContext.request.contextPath }/resources/js/awardAsk/awardAskStuDelete.js"></script>