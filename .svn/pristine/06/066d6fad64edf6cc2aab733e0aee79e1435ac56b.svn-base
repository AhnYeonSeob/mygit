<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>

 <!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600&display=swap" rel="stylesheet">

<!-- SockJS CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.2/sockjs.min.js"></script>

<!-- STOMP CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>


<style>
   body {
       background-color: #f9f9f9;
        font-family: 'Nunito', Arial, sans-serif; /* 동글동글한 폰트 적용 */
   }

   .container {
       max-width: 1200px;
       margin: 20px auto;
       display: flex;
       gap: 20px;
   }

   /* 왼쪽 패널 (차트 영역) */
   .left-panel {
       flex: 0.8; /* 크기 조정 */
       background-color: #fff;
       border-radius: 10px;
       box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
       padding: 20px;
       display: flex;
       flex-direction: column;
       gap: 20px;
       height: 600px;
   }

   .chart-container {
       flex: 1;
       border: 1px solid #ddd;
       border-radius: 10px;
       background-color: #f5f5f5;
       display: flex;
       align-items: center;
       justify-content: center;
       font-weight: 600; /* 차트 영역 텍스트에 약간 두께 추가 */
   }

   /* 오른쪽 패널 (채팅 영역) */
   .right-panel {
       flex: 1.2; /* 크기 조정 */
       background-color: #fff;
       border-radius: 10px;
       box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
       display: flex;
       flex-direction: column;
       overflow: hidden;
       height: 600px;
   }

   #message-container {
       flex: 1;
       padding: 20px;
       overflow-y: auto; /* 스크롤 활성화 */
       background-color: #f2f2f2;
   }

	 /* 메시지 스타일 */
    .message.sent {
        margin-bottom: 10px;
        display: flex;
        justify-content: flex-end; /* 기본 우측 정렬 */
        font-size: 14px; /* 글씨 크기 조정 */
    }

    .message.received {
        justify-content: flex-start; /* 받은 메시지는 좌측 정렬 */
    }
	
	.message .bubble {
          max-width: 70%;
          padding: 10px 15px;
          border-radius: 15px;
          font-size: 14px;
          line-height: 1.5;
          background-color: #007bff;
          color: white;
          border-bottom-right-radius: 5px;
      }

      .message.received .bubble {
          background-color: #e5e5ea;
          color: black;
          border-bottom-left-radius: 5px;
      }
	/* 입장 메시지 스타일 */
	.system-message .bubble {
	    background-color: #f0f0f0;
	    color: #666;
	    text-align: center;
	    border-radius: 10px;
	}
	
	
	
   #chat-input-container {
       display: flex;
       align-items: center;
       padding: 10px;
       background-color: #fff;
       border-top: 1px solid #ddd;
   }

   #message-input {
        flex: 1;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 20px;
        outline: none;
        font-family: 'Nunito', Arial, sans-serif;
   }

   #send-btn {
       margin-left: 10px;
       background-color: #007bff;
       color: white;
       border: none;
       border-radius: 20px;
       padding: 8px 16px;
       cursor: pointer;
       font-family: 'Nunito', Arial, sans-serif;
   }

   #send-btn:hover {
       background-color: #0056b3;
   }
</style>

 <div class="container">
        <!-- 왼쪽 패널 -->
        <div class="left-panel">
            <div class="chart-container" id="member-progress-chart">
                <p>프로젝트 멤버별 일감 진척도 차트</p>
            </div>
            <div class="chart-container" id="project-progress-chart">
                <p>프로젝트 진척도 차트</p>
            </div>
        </div>

        <!-- 오른쪽 패널 -->
        <div class="right-panel">
            <div id="message-container" data-path="${pageContext.request.contextPath }"
            	 data-task-no="${taskNo }" data-team-cd="${teamCd }" data-user="${pageContext.request.userPrincipal.name }">
            
                <!-- 스크롤 테스트용 메시지 -->
                <div class="message sent">
                    <div class="bubble">안녕하세요</div>
                </div>
                <div class="message received">
                    <div class="bubble">진행 상황을 공유합니다.</div>
                </div>
                <div class="message sent">
                    <div class="bubble">추가 작업이 필요합니다.</div>
                </div>
                
            </div>
            <div id="chat-input-container">
                <input type="text" id="message-input" placeholder="메시지를 입력하세요">
                <button id="send-btn">전송</button>
            </div>
        </div>
    </div>
 
 
<script src="${pageContext.request.contextPath }/resources/js/projectChatRoom/projectChat.js"></script> 