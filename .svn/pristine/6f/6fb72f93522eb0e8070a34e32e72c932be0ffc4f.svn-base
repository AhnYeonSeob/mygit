<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib uri="http://www.springframework.org/security/tags" prefix="security"%>
<c:set value="${pageContext.request.contextPath }" var="cp"/>


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
	href="https://fonts.googleapis.com/css2?family=Bitter:ital,wght@0,100..900;1,100..900&family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap"
	rel="stylesheet">
<style>
/*폰트스타일*/
.logo span {
	font-family: "Bitter", serif;
	font-optical-sizing: auto;
	font-weight: 500;
	font-style: normal;
	color: #000000;
}

/* 로고 이미지 비율 조정 */
.logo img {
	max-width: 60px; /* 로고 너비 조정 */
	max-height: 60px; /* 로고 높이 조정 */
	width: auto;
	height: auto;
	object-fit: contain; /* 이미지 비율을 유지하며 크기 맞추기 */
	margin-right: 15px; /* 텍스트와 로고 간 간격 */
}

/* 헤더 높이 설정 및 정렬 */
.header-nav {
	display: flex;
	align-items: center; /* 아이템 세로 정렬 */
	justify-content: flex-end; /* 아이템을 오른쪽 정렬 */
	min-height: 100px;
}

.d-flex {
	display: flex;
}

.align-items-center {
	align-items: center;
}

.justify-content-between {
	justify-content: space-between;
}

.flag-img {
	width: 20px; /* 원하는 너비 */
	height: auto; /* 비율을 유지한 채 높이를 자동으로 맞추기 */
}

.flag-item {
	margin-right: 10px; /* 우측에 10px 간격 추가 */
}

/* 부드러운 전환 효과 추가 */
.fade-transition {
    transition: opacity 0.5s ease, visibility 0.5s ease;
}

/* 숨김 상태 */
.hidden {
    opacity: 0;
    visibility: hidden;
}

/* 표시 상태 */
.visible {
    opacity: 1;
    visibility: visible;
}

.modal-header{
	background-color: #003399; 
	color: white;
}
</style>

</head>
		<security:authentication property="principal.realUser" var="user"/>
<input type="hidden" id="userId" name="userId" value="${id }">
<input type="hidden" id="contextPath" name="contextPath" value="${cp }">
<div class="d-flex align-items-center justify-content-between">
	<a href="${cp }"
		class="logo d-flex align-items-center"> <img
		src="${cp }/resources/NiceAdmin/assets/img/yglogo.png"
		alt="Logo"> <span class="d-none d-lg-block">YOUNGUN
			UNIVERSITY</span>
	</a> <i class="bi bi-list toggle-sidebar-btn"></i>
</div>
<!-- End Logo -->


<!--     <div class="search-bar"> -->
<!--       <form class="search-form d-flex align-items-center" method="POST" action="#"> -->
<!--         <input type="text" name="query" placeholder="Search" title="Enter search keyword"> -->
<!--         <button type="submit" title="Search"><i class="bi bi-search"></i></button> -->
<!--       </form> -->
<!--     </div>End Search Bar -->

<nav class="header-nav ms-auto">
	<ul class="d-flex align-items-center">

		<li class="nav-item d-block d-lg-none"><a
			class="nav-link nav-icon search-bar-toggle " href="#"> <i
				class="bi bi-search"></i>
		</a></li>
		<!-- End Search Icon-->

		<li class="nav-item flag-item"><a
			href="${cp }?lang=ko"><img
				src="${cp }/resources/NiceAdmin/assets/img/kr.png"
				alt="kr" class="flag-img"></a></li>


		<li class="nav-item flag-item"><a
			href="${cp }?lang=en"><img
				src="${cp }/resources/NiceAdmin/assets/img/usa.png"
				alt="usa" class="flag-img"></a></li>

		<li class="nav-item flag-item"><a
			href="${cp }?lang=jp"><img
				src="${cp }/resources/NiceAdmin/assets/img/jp.png"
				alt="jp" class="flag-img"></a></li>



		<li class="nav-item dropdown">
    <a class="nav-link nav-icon" href="#" data-bs-toggle="dropdown">
        <i class="bi bi-bell"></i>
        <span class="badge bg-primary badge-number"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow notifications" style="max-height: 300px; overflow-y: auto; width: 300px;">
        <li class="dropdown-header">
            알람 내역 리스트
            <a href="#"><span class="badge rounded-pill bg-primary p-2 ms-2" onclick="updateAllReadNotfication()">전체 읽음</span></a>
        </li>
        <li>
            <hr class="dropdown-divider">
        </li>
        <!-- 알림 항목들이 여기에 동적으로 추가됩니다 -->
    </ul>
</li>

			<!-- End Notification Dropdown Items --></li>
		<!-- End Notification Nav -->


		<%--       <c:set value="${pageContext.request.parameterMap }" var="paramMap"/> --%>
		<%--       <c:set value="?" var="qs"/> --%>
		<%--       <c:forEach items="${paramMap }" var="entry"> --%>
		<%--          <c:if test="${entry.key != 'lang'}"> --%>
		<%--             <c:forEach items="${entry.value }" var="value"> --%>
		<%--                <c:set value="${qs }${entry.key }=${value }&" var="queryString"/> --%>
		<%--             </c:forEach> --%>
		<%--          </c:if> --%>
		<%--       </c:forEach> --%>




		<c:if test="${empty pageContext.request.queryString }">
			<c:set var="qs" value="" />
		</c:if>
		<c:if test="${not empty pageContext.request.queryString }">
			<c:set var="qs" value="${pageContext.request.queryString }&" />
		</c:if>


		<li class="nav-item dropdown"><a class="nav-link nav-icon"
			href="#" data-bs-toggle="dropdown"> <i
				class="bi bi-chat-left-text"></i> <span
				class="badge bg-success badge-number"></span>
		</a>
		<!-- End Messages Icon -->

			<ul
				class="dropdown-menu dropdown-menu-end dropdown-menu-arrow messages">
				<li class="dropdown-header">You have 3 new messages <a href="#"><span
						class="badge rounded-pill bg-primary p-2 ms-2">View all</span></a>
				</li>
				<li>
					<hr class="dropdown-divider">
				</li>

				<li class="message-item"><a href="#"> <!-- <img src="assets/img/messages-1.jpg" alt="" class="rounded-circle"> -->
						<div>
							<h4>Maria Hudson</h4>
							<p>Velit asperiores et ducimus soluta repudiandae labore
								officia est ut...</p>
							<p>4 hrs. ago</p>
						</div>
				</a></li>
				<li>
					<hr class="dropdown-divider">
				</li>

				<li class="message-item"><a href="#"> <!-- <img src="assets/img/messages-2.jpg" alt="" class="rounded-circle"> -->
						<div>
							<h4>Anna Nelson</h4>
							<p>Velit asperiores et ducimus soluta repudiandae labore
								officia est ut...</p>
							<p>6 hrs. ago</p>
						</div>
				</a></li>
				<li>
					<hr class="dropdown-divider">
				</li>

				<li class="message-item"><a href="#"> <!-- <img src="assets/img/messages-3.jpg" alt="" class="rounded-circle"> -->
						<div>
							<h4>David Muldon</h4>
							<p>Velit asperiores et ducimus soluta repudiandae labore
								officia est ut...</p>
							<p>8 hrs. ago</p>
						</div>
				</a></li>
				<li>
					<hr class="dropdown-divider">
				</li>

				<li class="dropdown-footer"><a href="#">Show all messages</a></li>

			</ul>
			<!-- End Messages Dropdown Items --></li>
		<!-- End Messages Nav -->


		<li class="nav-item dropdown pe-3">
			<a class="nav-link nav-profile d-flex align-items-center pe-0" href="#" data-bs-toggle="dropdown">
			<c:if test="${empty user.proflPhoto }">
				<c:set value="${cp }/resources/NiceAdmin/assets/img/user.png" var="proflPhotoSrc"/>
			</c:if>
			<c:if test="${not empty user.proflPhoto }">
				<c:set value="data:image/*;base64,${user.proflPhoto }" var="proflPhotoSrc"/>
			</c:if>
			<img src="${proflPhotoSrc }" alt="Profile" class="rounded-circle">
			<span class="d-none d-md-block dropdown-toggle ps-2">
				${user.nm }
			</span>
		</a>
		<!-- End Profile Iamge Icon -->

			<ul
				class="dropdown-menu dropdown-menu-end dropdown-menu-arrow profile">
				<li class="dropdown-header">
					<h6>${user.nm }</h6> <span>${user.id }</span>
				</li>
				<li>
					<hr class="dropdown-divider">
				</li>

				<li><a class="dropdown-item d-flex align-items-center"
					href="javascript:void(0);"> <i class="bi bi-person"></i> <span>My
							Profile</span>
				</a></li>
				<li>
					<hr class="dropdown-divider">
				</li>

				<li><a class="dropdown-item d-flex align-items-center"
					href="javascript:void(0);"> <i class="bi bi-gear"></i> <span>Account
							Settings</span>
				</a></li>
				<li>
					<hr class="dropdown-divider">
				</li>

				<li><a class="dropdown-item d-flex align-items-center"
					href="javascript:void(0);"> <i class="bi bi-question-circle"></i> <span>Need
							Help?</span>
				</a></li>
				<li>
					<hr class="dropdown-divider">
				</li>

				<li>
					<form id="logoutForm"  class="dropdown-item d-flex align-items-center"  action="${cp }/logout" method="post">
					<i class="bi bi-box-arrow-right"></i>
						<button type="submit" style="display: none">로그아웃</button>
						<span style="cursor: pointer;" onclick="submitLogoutForm();">로그아웃</span>
					</form> 
				</li>

			</ul>
			<!-- End Profile Dropdown Items --></li>
		<!-- End Profile Nav -->

	</ul>
</nav>
<!-- End Icons Navigation -->

<script>
    function submitLogoutForm() {
        // JavaScript로 폼을 제출
        document.getElementById('logoutForm').submit();
    }
</script>
