package kr.or.ddit.yguniv.attendance.controller;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.HttpStatus;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.DeleteMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.PutMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.server.ResponseStatusException;

import kr.or.ddit.yguniv.attendance.service.AttendanceServiceImpl;
import kr.or.ddit.yguniv.vo.AttendanceVO;

// url 예상도
// 강의 / 강의과정 / attendance

@Controller
@RequestMapping("/attendance") // 여기서부터 애초에 조건을 나누어서 정해주면된다. lectNo로 나눈다 NM 쓰면안됨
public class AttendanceController {
	// (강의별로) 출결기록 조회
	
	@Autowired
	private AttendanceServiceImpl service;
	
//	@ModelAttribute
//	public void addAttendance(@PathVariable String stuId, Model model) {
//		AttendanceVO attendanceVO = service.selectAttendance(stuId);
//		if(attendanceVO == null) {
//			throw new ResponseStatusException(HttpStatus.NOT_FOUND, "해당 출결기록은 없습니다.");
//		}
//		model.addAttribute("attendance", attendanceVO);
//	}
		
	@GetMapping("attendan/{lectNo}")
	public String selectAttendance(Model model) {
		List<AttendanceVO>selectAttendanceList = service.selectAttendanceList();
	
		model.addAttribute("selectAttendanceList", selectAttendanceList);
		
		return "lecture/materials/attendance/attendanceList";
	}
	
	
	// GET 요청에서 모델 데이터를 설정
//    @GetMapping("/form")
//    public String showForm(Model model) {
//        List<String> items = someService.getItems(); // 데이터 조회
//        model.addAttribute("items", items); // 모델에 데이터 추가
//        return "form"; // JSP로 포워딩
//    }
      
	
	
	// 출결기록 상세조회
	@GetMapping("{stuId}")
	public String selectAttendanceDetail(@PathVariable()String stuId) {
		return "attendance/attendanceDetail";
	}
	
	
	
	// 출결기록 등록
	@GetMapping("/yguniv/createAttendance")
	public String insertAttendance() {
		return "attendance/attendanceForm";
	}
	
	// 출결기록 등록 2
	@PostMapping
	public String Attendance() {
		return "attendance/attendanceDetail";
	}
	
	// 출결기록 수정
	@PutMapping("{stuId}")
	public String updateAttendance(@PathVariable()String stuId) {
		return "attendance/attendanceList";
	}
	
	// 출결기록 삭제
	@DeleteMapping("{stuId}")
	public String deleteAttendance(@PathVariable()String stuId) {
		return "attendance/attendanceList";
	}
	
}
