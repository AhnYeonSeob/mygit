<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %> 
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn"%>


<h4 class="text-center">조별 과제 관리</h4>

<div class="project-container">
    <div class="menu-bar">
    	<!-- 상단 메뉴 -->
		<nav class="py-2 bg-light border-bottom">
		    <div class="container d-flex flex-wrap">
	            <ul class="nav me-auto">
	                <li class="nav-item">
	                    <a class="nav-link link-dark px-3 fw-bold fs-5 active" href="${pageContext.request.contextPath }/lecture/${lectNo}/projectTask">과제관리</a>
	                </li> 
	               
	                <li class="nav-item">
	                    <a class="nav-link link-dark px-3 fs-5 active" href="#">팀관리</a>
	                </li>
	            </ul>
	            <ul class="nav">
		       		<li><span class="total-students">총 수강생: <span id="studentCount">명</span></span></li>
		    	</ul>
		    </div>
		</nav>
    </div>
    
    <!-- 과제 테이블 -->
    <div class="task-table-wrapper">
        <div class="task-controls text-end">
            <a href="${pageContext.request.contextPath }/lecture/${lectNo}/projectTask/new" class="btn btn-primary">등록</a>
            <button class="btn btn-info" id="editTaskBtn">수정</button>
            <button class="btn btn-danger" id="deleteTaskBtn">삭제</button>
        </div>
        
        <table class="table table-bordered task-table">
            <thead>
                <tr>
                    <th><input type="checkbox" id="selectAll"></th>
                    <th>과제주제</th>
                    <th>과제제출마감일</th>
                    <th>배점</th>
                    <th>첨부파일</th>
                </tr>
            </thead>
            <tbody>
                <c:if test="${not empty projectTaskList }">
                    <c:forEach items="${projectTaskList }" var="task">
                        <tr>
                            <td><input type="checkbox" class="task-select" value="${task.taskNo }"></td>
                            <td>
                                <a href="<c:url value='/lecture/${task.lectNo}/projectTask/${task.taskNo }'/>">${task.taskTitle }</a>
                            </td>
                            <td>${fn:substring(task.taskEt, 0, 4)}-${fn:substring(task.taskEt, 4, 6)}-${fn:substring(task.taskEt, 6, 8)}</td>
                            <td>${task.taskScore }</td>
                            <td>
                                <c:choose>
                                    <c:when test="${not empty task.atchFileId }">
                                        <a href="<c:url value='/atch/${task.atchFileId }'/>">다운로드</a>
                                    </c:when>
                                    <c:otherwise>없음</c:otherwise>
                                </c:choose>
                            </td>
                        </tr>
                    </c:forEach>
                </c:if>
                <c:if test="${empty projectTaskList }">
                    <tr>
                        <td colspan="5" class="text-center">등록된 과제가 없습니다.</td>
                    </tr>
                </c:if>
            </tbody>
        </table>
    </div>

</div>
