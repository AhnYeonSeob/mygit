<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn" %>
<%@ taglib uri="http://www.springframework.org/security/tags" prefix="security" %>

<style>
    /* 전체 테이블 스타일 */
    table.table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
        font-size: 16px;
        text-align: left;
    }

    table.table th, table.table td {
        padding: 12px;
        border: 1px solid #dee2e6;
    }

    table.table th {
        background-color: #f8f9fa;
        font-weight: bold;
        text-align: center;
    }

    /* 통합 피드백 스타일 */
    .feedback-section {
        margin-top: 20px;
        padding: 15px;
        background-color: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 5px;
    }

    .feedback-section h3 {
        margin-bottom: 10px;
        font-size: 18px;
        font-weight: bold;
        color: #343a40;
    }

    .feedback-section .no-feedback {
        font-size: 14px;
        color: #6c757d;
        font-style: italic;
    }

    .feedback-section .feedback-content {
        font-size: 14px;
        color: #d9534f; /* 강조된 피드백 컬러 */
    }

    /* 버튼 영역 스타일 */
    .btn-area {
        margin-top: 20px;
        text-align: right;
    }
/*
    .btn-area .btn {
        display: inline-block;
        padding: 10px 20px;
        font-size: 14px;
        text-decoration: none;
        border-radius: 4px;
        margin-left: 10px;
        cursor: pointer;
    }

    .btn-area .btn-info {
        background-color: #17a2b8;
        color: #fff;
        border: none;
        transition: background-color 0.3s ease;
    }

    .btn-area .btn-info:hover {
        background-color: #138496;
    }

    .btn-area .btn-primary {
        background-color: #007bff;
        color: #fff;
        border: none;
        transition: background-color 0.3s ease;
    }

    .btn-area .btn-primary:hover {
        background-color: #0056b3;
    }
*/
    /* 테이블 내 텍스트 강조 */
    td#originalIntQue1, td#originalIntQue2, td#originalIntQue3 {
        color: #343a40; /* 기본 텍스트 색 */
    }

    td#originalIntQue1:hover,
    td#originalIntQue2:hover,
    td#originalIntQue3:hover {
        background-color: #e9ecef;
        cursor: pointer;
    }

    /* 첨부파일 스타일 */
    td[colspan="4"] a {
        text-decoration: none;
        color: #007bff;
        transition: color 0.2s ease;
    }

    td[colspan="4"] a:hover {
        color: #0056b3;
        text-decoration: underline;
    }
</style>

<h2>자기소개서 상세보기</h2>
<table class="table table-bordered" id="form-table" data-path="${pageContext.request.contextPath }">
    <tr>
        <th>학번</th>
        <td>${introduce.stuId}</td>
        <th>학년</th>
        <td>${introduce.commoncode.cocoStts}</td>
    </tr>
    <tr>
        <th>이름</th>
        <td>${introduce.person.nm}</td>
        <th>취업희망분야</th>
        <td>${introduce.employmentfield.empfiNm}</td>
    </tr>
    <tr>
        <th>자격증</th>
        <td colspan="3">
            <c:choose>
                <c:when test="${not empty introduce.certificate}">
                    <c:forEach var="cert" items="${introduce.certificate}" varStatus="status">
                     <span>자격증명: ${cert.certNm}</span>
            		<span>취득일: ${cert.certDate}</span>
                        <c:if test="${!status.last}">, </c:if>
                    </c:forEach>
                </c:when>
                <c:otherwise>
                    자격증 없음
                </c:otherwise>
            </c:choose>
        </td>
    </tr>
    <tr>
        <th>작성일자</th>
        <td>${introduce.intDate}</td>
        <th>첨삭일자</th>
        <td>${introduce.intUdate}</td>
    </tr>
    <tr>
<tr>
    <th>첨부파일</th>
    <td colspan="3">
        <c:forEach items="${introduce.certificate}" var="cert">
            <div>
                <!-- 첨부파일 정보 -->
                <c:if test="${not empty cert.atchFile && not empty cert.atchFile.fileDetails}">
                    <ul>
                        <c:forEach items="${cert.atchFile.fileDetails}" var="file">
                            <li>
                                <!-- file_stre_cours 활용 -->
                                <a href="${pageContext.request.contextPath}/atch/${cert.atchFile.atchFileId}/${file.fileSn}">
                                   증빙서류 다운로드
                                </a>
                            </li>
                        </c:forEach>
                    </ul>
                </c:if>
                <c:if test="${empty cert.atchFile || empty cert.atchFile.fileDetails}">
                    <p>첨부파일이 없습니다.</p>
                </c:if>
            </div>
        </c:forEach>
    </td>
</tr>

</table>

<!-- 항목별 기존 데이터 -->
<table class="table table-bordered">
    <thead>
        <tr>
            <th>지원동기</th>
            <th>입사 후 포부</th>
            <th>성격 및 장단점</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td id="originalIntQue1">${introduce.intQue1}</td>
            <td id="originalIntQue2">${introduce.intQue2}</td>
            <td id="originalIntQue3">${introduce.intQue3}</td>
        </tr>
    </tbody>
</table>

<!-- 통합 피드백 영역 -->
<div class="feedback-section">
    <h3 style="text-align: center;">통합 피드백</h3>
    <div>
        <c:if test="${empty introduce.intFeed}">
            <p class="no-feedback" style="color: #6c757d; font-style: italic;">피드백 사항이 존재하지 않습니다.</p>
        </c:if>
        <c:if test="${not empty introduce.intFeed}">
            <p class="feedback-content" style="color: #d9534f;">${introduce.intFeed}</p>
        </c:if>
    </div>
</div>

<div class="btn-area">
<security:authorize access="hasRole('EMPLOYEE')">
    <a href="<c:url value='/introduce/edit/${introduce.intCd}' />" class="btn btn-info">피드백 작성</a>
    <a href="<c:url value='/introduce' />" class="btn btn-primary">목록</a>
</security:authorize>

<security:authorize access="hasRole('STUDENT')">
    <a href="<c:url value='/introduce/list/${introduce.stuId }' />" class="btn btn-primary">목록</a>
</security:authorize>
    
    
</div>



